#!/bin/bash

# Generate file listing to parse:
cd /mnt/data/HistoricalArchive
find * -type f -exec du {} + > /tmp/all-HistoricalArchive-files.txt 

# Extension list from: https://fileinfo.com/filetypes/video
cat<<'EOF'>/tmp/video_files_pattern.txt
.*\.264$
.*\.3G2$
.*\.3GP$
.*\.3GP2$
.*\.3GPP$
.*\.3GPP2$
.*\.3MM$
.*\.3P2$
.*\.60D$
.*\.787$
.*\.89$
.*\.AAF$
.*\.AEC$
.*\.AECAP$
.*\.AEGRAPHIC$
.*\.AEP$
.*\.AEPX$
.*\.AET$
.*\.AETX$
.*\.AJP$
.*\.ALE$
.*\.AM$
.*\.AMC$
.*\.AMV$
.*\.AMX$
.*\.ANIM$
.*\.ANX$
.*\.AQT$
.*\.ARCUT$
.*\.ARF$
.*\.ASF$
.*\.ASX$
.*\.AV$
.*\.AV3$
.*\.AVB$
.*\.AVC$
.*\.AVCHD$
.*\.AVD$
.*\.AVE$
.*\.AVI$
.*\.AVM$
.*\.AVP$
.*\.AVR$
.*\.AVS$
.*\.AVS$
.*\.AVV$
.*\.AWLIVE$
.*\.AXM$
.*\.AXV$
.*\.BDM$
.*\.BDMV$
.*\.BDT2$
.*\.BDT3$
.*\.BIK$
.*\.BIK2$
.*\.BIN$
.*\.BIX$
.*\.BK2$
.*\.BLZ$
.*\.BMC$
.*\.BMK$
.*\.BNP$
.*\.BOX$
.*\.BS4$
.*\.BSF$
.*\.BU$
.*\.BVR$
.*\.BYU$
.*\.CAMPROJ$
.*\.CAMREC$
.*\.CAMV$
.*\.CED$
.*\.CEL$
.*\.CINE$
.*\.CIP$
.*\.CLK$
.*\.CLPI$
.*\.CME$
.*\.CMMP$
.*\.CMMTPL$
.*\.CMPROJ$
.*\.CMREC$
.*\.CMV$
.*\.CPI$
.*\.CPVC$
.*\.CREC$
.*\.CST$
.*\.CVC$
.*\.CX3$
.*\.D2V$
.*\.D3V$
.*\.DAD$
.*\.DASH$
.*\.DAT$
.*\.DAV$
.*\.DB2$
.*\.DCE$
.*\.DCK$
.*\.DCR$
.*\.DCR$
.*\.DDAT$
.*\.DIF$
.*\.DIR$
.*\.DIVX$
.*\.DLX$
.*\.DMB$
.*\.DMSD$
.*\.DMSD3D$
.*\.DMSM$
.*\.DMSM3D$
.*\.DMSS$
.*\.DMX$
.*\.DNC$
.*\.DPA$
.*\.DPG$
.*\.DREAM$
.*\.DSY$
.*\.DV$
.*\.DV-AVI$
.*\.DV4$
.*\.DVDMEDIA$
.*\.DVR$
.*\.DVR-MS$
.*\.DVX$
.*\.DXR$
.*\.DZM$
.*\.DZP$
.*\.DZT$
.*\.EDL$
.*\.EVO$
.*\.EVO$
.*\.EXO$
.*\.EXP$
.*\.EYE$
.*\.EYETV$
.*\.EZT$
.*\.F4F$
.*\.F4M$
.*\.F4P$
.*\.F4V$
.*\.FBR$
.*\.FBR$
.*\.FBZ$
.*\.FCARCH$
.*\.FCP$
.*\.FCPROJECT$
.*\.FFD$
.*\.FFM$
.*\.FLC$
.*\.FLH$
.*\.FLI$
.*\.FLIC$
.*\.FLV$
.*\.FLX$
.*\.FPDX$
.*\.FTC$
.*\.FVT$
.*\.G2M$
.*\.G64$
.*\.G64X$
.*\.GCS$
.*\.GFP$
.*\.GIFV$
.*\.GL$
.*\.GOM$
.*\.GRASP$
.*\.GTS$
.*\.GVI$
.*\.GVP$
.*\.GXF$
.*\.H264$
.*\.HDMOV$
.*\.HDV$
.*\.HEVC$
.*\.HKM$
.*\.IFO$
.*\.IMOVIELIBRARY$
.*\.IMOVIEMOBILE$
.*\.IMOVIEPROJ$
.*\.IMOVIEPROJECT$
.*\.INP$
.*\.INSV$
.*\.INT$
.*\.IRCP$
.*\.IRF$
.*\.ISM$
.*\.ISMC$
.*\.ISMCLIP$
.*\.ISMV$
.*\.IVA$
.*\.IVF$
.*\.IVR$
.*\.IVS$
.*\.IZZ$
.*\.IZZY$
.*\.JDR$
.*\.JMV$
.*\.JNR$
.*\.JSS$
.*\.JTS$
.*\.JTV$
.*\.K3G$
.*\.KDENLIVE$
.*\.KMV$
.*\.KTN$
.*\.LREC$
.*\.LRV$
.*\.LSF$
.*\.LSX$
.*\.LVIX$
.*\.M15$
.*\.M1PG$
.*\.M1V$
.*\.M21$
.*\.M21$
.*\.M2A$
.*\.M2P$
.*\.M2T$
.*\.M2TS$
.*\.M2V$
.*\.M4E$
.*\.M4U$
.*\.M4V$
.*\.M75$
.*\.MANI$
.*\.META$
.*\.MGV$
.*\.MJ2$
.*\.MJP$
.*\.MJPEG$
.*\.MJPG$
.*\.MK3D$
.*\.MKV$
.*\.MMV$
.*\.MNV$
.*\.MOB$
.*\.MOD$
.*\.MODD$
.*\.MOFF$
.*\.MOI$
.*\.MOOV$
.*\.MOV$
.*\.MOVIE$
.*\.MOVIE$
.*\.MP21$
.*\.MP21$
.*\.MP2V$
.*\.MP4$
.*\.MP4.INFOVID$
.*\.MP4V$
.*\.MPE$
.*\.MPEG$
.*\.MPEG1$
.*\.MPEG2$
.*\.MPEG4$
.*\.MPF$
.*\.MPG$
.*\.MPG2$
.*\.MPG4$
.*\.MPGINDEX$
.*\.MPL$
.*\.MPL$
.*\.MPLS$
.*\.MPROJ$
.*\.MPSUB$
.*\.MPV$
.*\.MPV2$
.*\.MQV$
.*\.MSDVD$
.*\.MSE$
.*\.MSH$
.*\.MSWMM$
.*\.MT2S$
.*\.MTS$
.*\.MTV$
.*\.MVB$
.*\.MVC$
.*\.MVD$
.*\.MVE$
.*\.MVEX$
.*\.MVP$
.*\.MVP$
.*\.MVY$
.*\.MXF$
.*\.MXV$
.*\.MYS$
.*\.N3R$
.*\.NCOR$
.*\.NFV$
.*\.NSV$
.*\.NTP$
.*\.NUT$
.*\.NUV$
.*\.NVC$
.*\.OGM$
.*\.OGV$
.*\.OGX$
.*\.ORV$
.*\.OSP$
.*\.OTRKEY$
.*\.PAC$
.*\.PAR$
.*\.PDS$
.*\.PGI$
.*\.PHOTOSHOW$
.*\.PIV$
.*\.PJS$
.*\.PLAYLIST$
.*\.PLPROJ$
.*\.PMF$
.*\.PMV$
.*\.PNS$
.*\.PPJ$
.*\.PREL$
.*\.PRO$
.*\.PRO4DVD$
.*\.PRO5DVD$
.*\.PROQC$
.*\.PRPROJ$
.*\.PRTL$
.*\.PSB$
.*\.PSH$
.*\.PSSD$
.*\.PSV$
.*\.PVA$
.*\.PVR$
.*\.PXV$
.*\.PZ$
.*\.QSV$
.*\.QT$
.*\.QTCH$
.*\.QTINDEX$
.*\.QTL$
.*\.QTM$
.*\.QTZ$
.*\.R3D$
.*\.RAVI$
.*\.RCD$
.*\.RCPROJECT$
.*\.RCREC$
.*\.RCUT$
.*\.RDB$
.*\.REC$
.*\.RM$
.*\.RMD$
.*\.RMD$
.*\.RMP$
.*\.RMS$
.*\.RMV$
.*\.RMVB$
.*\.ROQ$
.*\.RP$
.*\.RSX$
.*\.RTS$
.*\.RTS$
.*\.RUM$
.*\.RV$
.*\.RVID$
.*\.RVL$
.*\.SAN$
.*\.SBK$
.*\.SBT$
.*\.SBZ$
.*\.SCC$
.*\.SCM$
.*\.SCM$
.*\.SCN$
.*\.SCREENFLOW$
.*\.SDV$
.*\.SEC$
.*\.SEC$
.*\.SEDPRJ$
.*\.SEQ$
.*\.SER$
.*\.SFD$
.*\.SFERA$
.*\.SFVIDCAP$
.*\.SIV$
.*\.SMI$
.*\.SMI$
.*\.SMIL$
.*\.SMK$
.*\.SML$
.*\.SMV$
.*\.SNAGPROJ$
.*\.SPL$
.*\.SQZ$
.*\.SRT$
.*\.SSF$
.*\.SSM$
.*\.STL$
.*\.STR$
.*\.STX$
.*\.SVI$
.*\.SWF$
.*\.SWI$
.*\.SWT$
.*\.TDA3MT$
.*\.TDT$
.*\.TDX$
.*\.THEATER$
.*\.THP$
.*\.TID$
.*\.TIVO$
.*\.TIX$
.*\.TOD$
.*\.TP$
.*\.TP0$
.*\.TPD$
.*\.TPR$
.*\.TREC$
.*\.TRP$
.*\.TS$
.*\.TSP$
.*\.TSV$
.*\.TTXT$
.*\.TVLAYER$
.*\.TVRECORDING$
.*\.TVS$
.*\.TVSHOW$
.*\.USF$
.*\.USM$
.*\.V264$
.*\.VBC$
.*\.VC1$
.*\.VCPF$
.*\.VCR$
.*\.VCV$
.*\.VDO$
.*\.VDR$
.*\.VDX$
.*\.VEG$
.*\.VEM$
.*\.VEP$
.*\.VF$
.*\.VFT$
.*\.VFW$
.*\.VFZ$
.*\.VGZ$
.*\.VID$
.*\.VIDEO$
.*\.VIEWLET$
.*\.VIV$
.*\.VIVO$
.*\.VIX$
.*\.VLAB$
.*\.VMLF$
.*\.VMLT$
.*\.VOB$
.*\.VP3$
.*\.VP6$
.*\.VP7$
.*\.VPJ$
.*\.VR$
.*\.VRO$
.*\.VS4$
.*\.VSE$
.*\.VSH$
.*\.VSP$
.*\.VTT$
.*\.W32$
.*\.WCP$
.*\.WEBM$
.*\.WFSP$
.*\.WGI$
.*\.WLMP$
.*\.WM$
.*\.WMD$
.*\.WMMP$
.*\.WMV$
.*\.WMX$
.*\.WOT$
.*\.WP3$
.*\.WPL$
.*\.WSVE$
.*\.WTV$
.*\.WVM$
.*\.WVX$
.*\.WXP$
.*\.XEJ$
.*\.XEL$
.*\.XESC$
.*\.XFL$
.*\.XLMV$
.*\.XMV$
.*\.XVID$
.*\.Y4M$
.*\.YOG$
.*\.YUV$
.*\.ZEG$
.*\.ZM1$
.*\.ZM2$
.*\.ZM3$
.*\.ZMV$
EOF

# Filter to files creater than 999KB
grep -E '^[0-9][0-9][0-9][0-9]' /tmp/all-HistoricalArchive-files.txt > /tmp/all-HistoricalArchive-files-1MB.txt

# gawk and loop through all the above extension, case insensitive. This will take approximately 30 minutes on a 800k line file. If you run this on the 8MM line all files, expect it to take 5 hours.
gawk 'BEGIN {IGNORECASE = 1} NR==FNR {query[$0]=1; next} {for (q in query) if ($0~q) {print; break}}' /tmp/video_files_pattern.txt /tmp/all-HistoricalArchive-files-1MB.txt > /tmp/video_files-HistoricalArchive-1MB.txt
